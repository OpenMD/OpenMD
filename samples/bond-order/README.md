# Bond Order

## Background Information

One way to study the local environments around atoms is the use of
Bond-orientational order parameters. These were first presented in

> "Bond-orientaional order in liquids and glasses," P. J. Steinhart,
> D. R. Nelson, and M. Ronchetti, Phys. Rev. B, 28, 784 (1983).

and formulae for individual atoms appeared in:

> "Numerical calculation of the rate of crystal nucleation in a
> Lennard-Jones system at moderate undercooling," Pieter Rein ten
> Wolde, Maria J. Ruiz-Montero, and Daan Frenkel, J. Chem. Phys. 104,
> pp.  9932-9947 (1996).

`StaticProps` can compute bond orientational order parameters, using a
single cutoff radius to decide membership in the list of neighbors,
and does not use a distance-dependent weighting as used in the
second reference above.

## Instructions

This directory contains sample files used to test the orientational
bond order parameter code in `StaticProps`.  Perfect simple cubic
(SC), body-centered cubic (BCC), face-centered cubic (FCC), hexagonal
close packed (HCP), and Icosahedral clusters have known analytic
values for the bond order parameter and the files in this directory
can be used to make sure the correct values are being computed.  The
central atom in each cluster is a copper atom, so the proper way to
run the tests would be a command like:

```bash
StaticProps --bo -i bcc.omd --rcut=9 --sele1="select Cu"
```

The selection script will look at specific types of central atoms - in
this case, copper, and dynamic selections can also be utilized,
e.g. `--sele1="within(5, Au)"`.  By default, this command computes the
$Q_{l}$ and $\hat{W}_{l}$ parameters up to $l = 12$.  The
configurational averages of these values as well as the distributions
of atomic $q_{l}$ and $\hat{w}_{l}$ values are then placed in `.boq`
and `.bow` files.

The `bcc.boq` file that is generated by the command above should look
like (only the header is shown):

```
# Bond Order Parameters
# selection script: "select Cu"
# parameters:  rcut = 9, nbins = 0
# <Q_0>: 1
# <Q_1>: 3.37141e-17
# <Q_2>: 5.54483e-17
# <Q_3>: 2.99407e-17
# <Q_4>: 0.0363696
# <Q_5>: 8.02427e-17
# <Q_6>: 0.510688
# <Q_7>: 2.17378e-16
# <Q_8>: 0.429322
# <Q_9>: 1.07533e-16
# <Q_10>: 0.195191
# <Q_11>: 3.16477e-16
# <Q_12>: 0.404799
``` 

And there is a companion `bcc.bow` file that is also generated:

```
# Bond Order Parameters
# selection script: "select Cu"
# parameters:  rcut = 9, nbins = 0
# <W_0>: 1      0
# <W_1>: 0      0
# <W_2>: 0.0628896      0
# <W_3>: 0      0
# <W_4>: 0.159317       -1.6293e-31
# <W_5>: 0      0
# <W_6>: 0.0131606      -4.76796e-51
# <W_7>: 0      0
# <W_8>: 0.0584548      -1.31476e-34
# <W_9>: 0      0
# <W_10>: -0.0901302    3.49515e-33
# <W_11>: 0     0
# <W_12>: -0.0495736    1.21542e-33

``` 

These headers contain the mean values of $\langle Q_n \rangle$ and
$\langle \hat{W}_n \rangle$ order parameters for the selected atoms
(in this case Cu) for $n=0 \rightarrow 12$. Note that $\langle
\hat{W}_n \rangle$ can have both real and imaginary contributions, so
both are given.

Immediately following the lines above are normalized distributions of
$Q_n$ or $\hat{W}_n$.  The data is formatted with increasing values of
$Q$ and $\hat{W}$ in the first column, and probability distributions
of the order parameters are in successive columns.

## Expected Output

The test files in this directory are simple structures with Cu atoms
located at (0,0,0), and Au atoms surrounding Cu in the clusters.  The
analytically-derived output values for $n=4$ and $n=6$ are:

| file            | Contents               | $Q_4$ | $Q_6$ |$\hat{W}_4$|$\hat{W}_6$|
|-----------------|------------------------|-------|-------|--------|--------|
| hcp.omd         | Hexagonal Close Packed | 0.097 | 0.485 |  0.134 | -0.012 |
| bcc.omd         | Body Centered Cubic    | 0.036 | 0.511 |  0.159 |  0.013 |
| fcc.omd         | Face Centered Cubic    | 0.191 | 0.575 | -0.159 | -0.013 |
| sc.omd          | Simple Cubic           | 0.764 | 0.354 |  0.159 |  0.013 |
| icosahedron.omd | Icosahedral cluster    | 0     | 0.663 |  0     | -0.170 |
| surface_icosahedron.omd | Half of an Icosahedral Cluster approximating a nanoparticle surface atom | 0 | 0.663 | ~0 | -0.17 |
| tet.omd         | Tetrahedral cluster    | 0.509 | 0.629 | -0.159 |  0.013 |

Note that for tetrahedral clusters, $Q_3 \sim 0.745$, and the $l =
4,6$ order parameters are less useful disricminators of
structure.
